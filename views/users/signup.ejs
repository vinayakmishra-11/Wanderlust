<% layout('layouts/boilerplate') %>

<style>
/* Signup Page Styling */
.signup-container {
    min-height: calc(100vh - 160px);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px 24px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.signup-card {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    padding: 48px;
    width: 100%;
    max-width: 440px;
    position: relative;
    overflow: hidden;
}

.signup-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(to right, #e61e4d 0%, #e31c5f 50%, #d70466 100%);
}

.signup-header {
    text-align: center;
    margin-bottom: 32px;
}

.signup-logo {
    font-size: 32px;
    color: #ff385c;
    margin-bottom: 16px;
}

.signup-title {
    font-size: 28px;
    font-weight: 600;
    color: #222;
    margin-bottom: 8px;
}

.signup-subtitle {
    font-size: 16px;
    color: #717171;
    font-weight: 400;
}

.signup-form {
    width: 100%;
}

.form-group {
    margin-bottom: 24px;
    position: relative;
}

.form-label {
    font-size: 14px;
    font-weight: 600;
    color: #222;
    margin-bottom: 8px;
    display: block;
    text-transform: capitalize;
}

.form-control {
    width: 100%;
    padding: 16px;
    border: 1.5px solid #ddd;
    border-radius: 8px;
    font-size: 16px;
    font-family: inherit;
    transition: all 0.2s ease;
    background: #fff;
}

.form-control:focus {
    outline: none;
    border-color: #222;
    box-shadow: 0 0 0 3px rgba(34, 34, 34, 0.1);
}

.form-control::placeholder {
    color: #b0b0b0;
}

.input-icon {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: #717171;
    font-size: 16px;
    pointer-events: none;
}

.password-toggle {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: #717171;
    cursor: pointer;
    font-size: 16px;
    transition: color 0.2s ease;
}

.password-toggle:hover {
    color: #222;
}

.signup-button {
    width: 100%;
    background: linear-gradient(to right, #e61e4d 0%, #e31c5f 50%, #d70466 100%);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-top: 8px;
    position: relative;
    overflow: hidden;
    text-transform: capitalize;
}

.signup-button:hover {
    background: linear-gradient(to right, #d50027 0%, #d50027 50%, #d50027 100%);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(230, 30, 77, 0.4);
}

.signup-button:active {
    transform: translateY(0);
}

.signup-button:disabled {
    background: #ddd;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

.button-text {
    transition: opacity 0.2s ease;
}

.button-spinner {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    opacity: 0;
    transition: opacity 0.2s ease;
}

.signup-button.loading .button-text {
    opacity: 0;
}

.signup-button.loading .button-spinner {
    opacity: 1;
}

.spinner {
    width: 20px;
    height: 20px;
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    border-top-color: white;
    animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.signup-links {
    text-align: center;
    margin-top: 32px;
    padding-top: 24px;
    border-top: 1px solid #f0f0f0;
}

.signup-link {
    color: #222;
    text-decoration: none;
    font-weight: 500;
    font-size: 14px;
    transition: color 0.2s ease;
}

.signup-link:hover {
    color: #ff385c;
    text-decoration: none;
}

.validation-feedback {
    font-size: 14px;
    margin-top: 6px;
    padding: 8px 12px;
    border-radius: 6px;
}

.valid-feedback {
    color: #008A05;
    background: #F7FDF7;
    border-left: 3px solid #008A05;
    display: none;
}

.invalid-feedback {
    color: #C13515;
    background: #FEF7F0;
    border-left: 3px solid #C13515;
    display: none;
}

.form-control.is-valid {
    border-color: #008A05;
}

.form-control.is-invalid {
    border-color: #C13515;
}

.form-control.is-valid ~ .valid-feedback {
    display: block;
}

.form-control.is-invalid ~ .invalid-feedback {
    display: block;
}

/* Password strength indicator */
.password-strength {
    margin-top: 8px;
    display: none;
}

.strength-bar {
    height: 4px;
    border-radius: 2px;
    background: #f0f0f0;
    margin-bottom: 4px;
    overflow: hidden;
}

.strength-fill {
    height: 100%;
    width: 0%;
    transition: all 0.3s ease;
    border-radius: 2px;
}

.strength-weak { background: #ff4757; width: 25%; }
.strength-fair { background: #ffa502; width: 50%; }
.strength-good { background: #2ed573; width: 75%; }
.strength-strong { background: #0fbcf9; width: 100%; }

.strength-text {
    font-size: 12px;
    color: #717171;
}

/* Terms and conditions */
.terms-notice {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 16px;
    margin-top: 24px;
    font-size: 13px;
    color: #6c757d;
    line-height: 1.4;
}

.terms-notice a {
    color: #ff385c;
    text-decoration: none;
}

.terms-notice a:hover {
    text-decoration: underline;
}

/* Responsive Design */
@media (max-width: 768px) {
    .signup-container {
        padding: 24px 16px;
        background: #fff;
    }
    
    .signup-card {
        padding: 32px 24px;
        box-shadow: none;
        border-radius: 0;
    }
    
    .signup-title {
        font-size: 24px;
    }
}

@media (max-width: 480px) {
    .signup-card {
        padding: 24px 20px;
    }
    
    .signup-title {
        font-size: 22px;
    }
}

/* Animation for form appearance */
.signup-card {
    animation: slideUp 0.5s ease-out;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Focus states for accessibility */
.form-control:focus,
.signup-button:focus {
    outline: 2px solid #ff385c;
    outline-offset: 2px;
}

/* Security indicator */
.security-badge {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: 24px;
    padding: 12px;
    background: #f8f9fa;
    border-radius: 6px;
    font-size: 12px;
    color: #6c757d;
}

.security-badge i {
    color: #28a745;
}
</style>

<div class="signup-container">
    <div class="signup-card">
        <!-- Header -->
        <div class="signup-header">
            <div class="signup-logo">
                <i class="fa-solid fa-compass"></i>
            </div>
            <h1 class="signup-title">Join Wanderlust</h1>
            <p class="signup-subtitle">Create your account and start exploring</p>
        </div>

        <!-- Signup Form -->
        <form action="/signup" method="post" class="signup-form needs-validation" novalidate id="signupForm">
            <div class="form-group">
                <label for="username" class="form-label">Username</label>
                <div style="position: relative;">
                    <input 
                        name="username"
                        id="username"
                        type="text"
                        class="form-control"
                        placeholder="Choose a unique username"
                        required
                        autocomplete="username">
                    <i class="input-icon fa-solid fa-user"></i>
                </div>
                <div class="valid-feedback">Looks good!</div>
                <div class="invalid-feedback">Please choose a username.</div>
            </div>

            <div class="form-group">
                <label for="email" class="form-label">Email Address</label>
                <div style="position: relative;">
                    <input 
                        name="email"
                        id="email"
                        type="email"
                        class="form-control"
                        placeholder="Enter your email address"
                        required
                        autocomplete="email">
                    <i class="input-icon fa-solid fa-envelope"></i>
                </div>
                <div class="valid-feedback">Email looks great!</div>
                <div class="invalid-feedback">Please provide a valid email address.</div>
            </div>

            <div class="form-group">
                <label for="password" class="form-label">Password</label>
                <div style="position: relative;">
                    <input 
                        name="password"
                        id="password"
                        type="password"
                        class="form-control"
                        placeholder="Create a secure password"
                        required
                        autocomplete="new-password">
                    <i class="password-toggle fa-solid fa-eye" id="passwordToggle"></i>
                </div>
                
                <!-- Password Strength Indicator -->
                <div class="password-strength" id="passwordStrength">
                    <div class="strength-bar">
                        <div class="strength-fill" id="strengthFill"></div>
                    </div>
                    <div class="strength-text" id="strengthText"></div>
                </div>
                
                <div class="valid-feedback">Strong password!</div>
                <div class="invalid-feedback">Please create a password.</div>
            </div>

            <button type="submit" class="signup-button" id="signupButton">
                <span class="button-text">
                    <i class="fa-solid fa-user-plus me-2"></i>
                    Sign up
                </span>
                <div class="button-spinner">
                    <div class="spinner"></div>
                </div>
            </button>
        </form>

        <!-- Terms Notice -->
        <div class="terms-notice">
            By signing up, you agree to our <a href="#" target="_blank">Terms of Service</a> and <a href="#" target="_blank">Privacy Policy</a>. 
            We'll occasionally send you account-related emails.
        </div>

        <!-- Links -->
        <div class="signup-links">
            <p style="margin: 0; color: #717171; font-size: 14px;">
                Already have an account? 
                <a href="/login" class="signup-link">Sign in here</a>
            </p>
        </div>

        <!-- Security Badge -->
        <div class="security-badge">
            <i class="fa-solid fa-shield-halved"></i>
            <span>Your information is protected with industry-standard encryption</span>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('signupForm');
    const signupButton = document.getElementById('signupButton');
    const passwordToggle = document.getElementById('passwordToggle');
    const passwordInput = document.getElementById('password');
    const passwordStrength = document.getElementById('passwordStrength');
    const strengthFill = document.getElementById('strengthFill');
    const strengthText = document.getElementById('strengthText');

    // Password visibility toggle
    passwordToggle.addEventListener('click', function() {
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
        
        // Toggle icon
        if (type === 'text') {
            passwordToggle.classList.remove('fa-eye');
            passwordToggle.classList.add('fa-eye-slash');
        } else {
            passwordToggle.classList.remove('fa-eye-slash');
            passwordToggle.classList.add('fa-eye');
        }
    });

    // Password strength checker
    passwordInput.addEventListener('input', function() {
        const password = this.value;
        const strength = calculatePasswordStrength(password);
        
        if (password.length > 0) {
            passwordStrength.style.display = 'block';
            updatePasswordStrength(strength);
        } else {
            passwordStrength.style.display = 'none';
        }
    });

    function calculatePasswordStrength(password) {
        let score = 0;
        let feedback = '';

        if (password.length >= 8) score++;
        if (/[a-z]/.test(password)) score++;
        if (/[A-Z]/.test(password)) score++;
        if (/[0-9]/.test(password)) score++;
        if (/[^A-Za-z0-9]/.test(password)) score++;

        switch (score) {
            case 0:
            case 1:
                return { level: 'weak', text: 'Weak password' };
            case 2:
                return { level: 'fair', text: 'Fair password' };
            case 3:
            case 4:
                return { level: 'good', text: 'Good password' };
            case 5:
                return { level: 'strong', text: 'Strong password' };
            default:
                return { level: 'weak', text: 'Weak password' };
        }
    }

    function updatePasswordStrength(strength) {
        strengthFill.className = `strength-fill strength-${strength.level}`;
        strengthText.textContent = strength.text;
    }

    // Form validation
    form.addEventListener('submit', function(e) {
        if (!form.checkValidity()) {
            e.preventDefault();
            e.stopPropagation();
            
            // Add validation classes
            const inputs = form.querySelectorAll('input[required]');
            inputs.forEach(input => {
                if (!input.checkValidity()) {
                    input.classList.add('is-invalid');
                } else {
                    input.classList.remove('is-invalid');
                }
            });
        } else {
            // Show loading state but allow form submission
            signupButton.classList.add('loading');
            signupButton.disabled = true;
        }
        
        form.classList.add('was-validated');
    });

    // Real-time validation
    const inputs = form.querySelectorAll('input[required]');
    inputs.forEach(input => {
        input.addEventListener('input', function() {
            if (this.checkValidity()) {
                this.classList.remove('is-invalid');
                this.classList.add('is-valid');
            } else if (this.value.trim() !== '') {
                this.classList.remove('is-valid');
                this.classList.add('is-invalid');
            }
        });

        input.addEventListener('blur', function() {
            if (this.value.trim() !== '') {
                if (this.checkValidity()) {
                    this.classList.remove('is-invalid');
                    this.classList.add('is-valid');
                } else {
                    this.classList.remove('is-valid');
                    this.classList.add('is-invalid');
                }
            }
        });
    });

    // Reset loading state if form submission fails
    window.addEventListener('pageshow', function() {
        signupButton.classList.remove('loading');
        signupButton.disabled = false;
    });
});
</script>